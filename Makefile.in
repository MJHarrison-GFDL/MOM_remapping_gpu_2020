FC = @FC@
LD = @FC@
FCFLAGS = @FCFLAGS@
LDFLAGFS= @LDFLAGS@


# Macros
.PHONY: all

all: prg_remap prg_unit_tests


# Dependencies

COMMON_OBS = MOM_remapping.o MOM_error_handler.o  MOM_string_functions.o \
             regrid_edge_values.o PLM_functions.o regrid_solvers.o polynomial_functions.o
prg_remap: prg_remap.o $(COMMON_OBS)
prg_unit_tests: prg_unit_tests.o $(COMMON_OBS)

prg_remap.o prg_unit_tests.o: MOM_remapping.o
MOM_remapping.o: MOM_error_handler.o regrid_edge_values.o PLM_functions.o MOM_string_functions.o
regrid_edge_values.o: MOM_error_handler.o regrid_solvers.o polynomial_functions.o
PLM_functions.o: MOM_error_handler.o
regrid_solvers.o: MOM_error_handler.o


# Rules

prg_remap prg_unit_tests:
	$(LD) $(LDFLAGS) -o $@ $^

%.o: @srcdir@/src/%.F90
	$(FC) $(FCFLAGS) -c $<


# Cleanup
.PHONY: clean distclean ac-clean

clean:
	rm -f prg_* *.o *.mod

distclean: clean
	rm -f config.log
	rm -f config.status
	rm -f Makefile

ac-clean: distclean
	rm -f @srcdir@/aclocal.m4
	rm -rf @srcdir@/autom4te.cache
	rm -f @srcdir@/configure
